# 統合台帳システム　ユーザーガイド

---

## 1. システムの主な機能

- **複数台帳（PC台帳・内線台帳・座席台帳）の統合検索・表示**
  - 各台帳の情報を一つのテーブルで横断的に閲覧・検索できます。
- **仮想スクロールテーブル**
  - 大量データでも高速に表示・操作が可能です。
- **テーブル内検索（複数キーワード対応）**
  - テーブル上部の検索ボックスから、全カラムを対象に部分一致検索ができます。
  - カンマ・スペース・改行で複数ワードを入力すると「いずれかを含む行（OR検索）」で絞り込みできます。
- **ダブルクリックで値コピー**
  - PC番号・内線番号・座席番号のセルをダブルクリックすると、その値をクリップボードにコピーできます。
  - コピー時は「コピーしました」と画面下部に通知が表示されます。
- **編集・変更フラグ管理**
  - 編集可能なセルは直接値を変更できます。
  - 変更した行には自動で「変更フラグ」が立ち、保存前に確認できます。
- **変更の一括保存**
  - 「変更を保存」ボタンで、編集した内容を一括で保存できます。
- **分離ボタン**
  - 主キーフィールドのセルに「分離」ボタンがあり、台帳の分離操作が可能です。

---

## 2. 操作手順

### 1. 検索・表示

1. 画面上部の「テーブル内検索」ボックスにキーワードを入力します。
   - 例：「山田」や「PC-001」など
   - 複数ワードの場合は「山田,PC-001」や「山田 PC-001」または改行で区切って入力
2. 入力したキーワードを含む行だけがテーブルに表示されます。

### 2. 値のコピー

- PC番号・内線番号・座席番号のセルを**ダブルクリック**すると、その値がコピーされます。
- コピー成功時は「コピーしました」と通知が表示されます。

### 3. データの編集

1. 編集可能なセルをクリックし、値を直接入力または選択します。
2. 変更したセルは色が変わり、行の「変更フラグ」も自動でONになります。

### 4. 変更の保存

- 編集が終わったら「変更を保存」ボタンをクリックしてください。
- 変更内容が一括で保存されます。

### 5. 分離操作

- 主キーフィールドのセルにある「分離」ボタンをクリックすると、該当台帳の分離操作が行えます。

---

## 3. Q&A（よくある質問）

### Q1. 検索はどのカラムが対象ですか？
A. テーブル内の**全てのカラム**が検索対象です。

### Q2. 複数のキーワードで検索できますか？
A. はい。カンマ（,）、スペース、改行で区切ることで、複数ワードの「OR検索」が可能です。

### Q3. 大文字・小文字は区別されますか？
A. いいえ。検索は**大文字・小文字を区別しません**。

### Q4. コピーできるのはどのセルですか？
A. PC番号・内線番号・座席番号のセルを**ダブルクリック**すると、その値のみコピーできます。

### Q5. 編集した内容はすぐに保存されますか？
A. いいえ。編集後は「変更を保存」ボタンをクリックして保存してください。

### Q6. 検索ボックスのオートコンプリートが出ませんが？
A. オートコンプリート（自動補完）は無効化されています。

### Q7. 検索ボックスの幅やデザインが他と違うのですが？
A. 検索ボックスは見やすさ・使いやすさを考慮し、幅500px・専用デザインになっています。

### Q8. 分離ボタンとは何ですか？
A. 主キーフィールドのセルにある「分離」ボタンを押すと、該当台帳のデータを分離できます。

### Q9. テーブルのデータはどのくらいの件数まで表示できますか？
A. 仮想スクロール方式のため、数千件～数万件でも快適に表示・操作できます。

### Q10. 検索結果が0件の場合はどうなりますか？
A. 「該当なし」などのメッセージが表示されます。

### Q11. 検索ボックスに全角スペースを入れても区切りとして認識されますか？
A. いいえ。区切りは半角スペース・カンマ・改行のみです。

### Q12. 検索ボックスでEnterキーを押すとどうなりますか？
A. 改行として認識され、複数ワード検索の区切りになります。

### Q13. 検索ボックスに記号や特殊文字を入力しても検索できますか？
A. はい。入力した文字列がテーブル内に含まれていれば検索可能です。

### Q14. 検索ボックスの値をクリアするとどうなりますか？
A. 全件表示に戻ります。

### Q15. 検索ボックスの幅は変更できますか？
A. 標準では500pxですが、システム管理者がスタイルを変更することで調整可能です。

### Q16. テーブルのカラム幅は変更できますか？
A. カラム幅はシステム設定（config.js）で調整可能です。

### Q17. 編集できないセルはどれですか？
A. グレーアウトしているセルや、readOnly設定のセルは編集できません。

### Q18. 編集したセルの色は何色ですか？
A. 編集したセルは背景色が変わり、視覚的に分かりやすくなっています。

### Q19. 変更フラグはどこで確認できますか？
A. 各行の「変更フラグ」列のチェックボックスで確認できます。

### Q20. 変更フラグは手動でON/OFFできますか？
A. いいえ。セル編集時に自動でONになり、元に戻すと自動でOFFになります。

### Q21. 編集内容を元に戻す方法はありますか？
A. セルの値を元の値に戻すと、変更フラグも自動でOFFになります。

### Q22. 編集内容を一括でキャンセルできますか？
A. ページをリロードすると未保存の編集内容は破棄されます。

### Q23. 保存ボタンを押した後、どのように反映されますか？
A. 変更内容がサーバーに送信され、保存完了後にテーブルが再描画されます。

### Q24. 保存に失敗した場合はどうなりますか？
A. エラーメッセージが表示され、再度保存を試みることができます。

### Q25. 保存ボタンはいつでも押せますか？
A. 編集内容がある場合のみ有効です。変更がない場合は無効化されます。

### Q26. テーブルの並び順は変更できますか？
A. 現状は固定ですが、今後ソート機能の追加も検討しています。

### Q27. テーブルのカラムを非表示にできますか？
A. 現状はできません。必要な場合は管理者にご相談ください。

### Q28. テーブルのデータをエクスポートできますか？
A. システムによっては「全データ抽出」ボタンでCSV等にエクスポート可能です。

### Q29. テーブルのデータをインポートできますか？
A. 現状はできません。データ追加・修正は画面上で行ってください。

### Q30. 検索ボックスのラベルや説明文は変更できますか？
A. システム管理者がソースコードを修正することで変更可能です。

### Q31. 検索ボックスの位置を変えられますか？
A. 標準では「統合検索結果」と「変更を保存」ボタンの間に表示されます。

### Q32. テーブルの高さは調整できますか？
A. ウィンドウサイズに応じて自動調整されます。

### Q33. スクロール位置は保存されますか？
A. テーブルの再描画時に直前のスクロール位置が復元されます。

### Q34. テーブルのヘッダーは固定されていますか？
A. はい。スクロールしてもヘッダーは常に表示されます。

### Q35. テーブルの行番号は表示されますか？
A. 現状は表示されませんが、必要に応じて追加可能です。

### Q36. テーブルのデータはどこから取得していますか？
A. 各台帳アプリのデータをAPI経由で取得・統合しています。

### Q37. テーブルのデータはリアルタイムで更新されますか？
A. いいえ。画面の再読み込みや検索実行時に最新データが反映されます。

### Q38. 編集履歴は残りますか？
A. 現状は残りません。必要な場合は管理者にご相談ください。

### Q39. 編集権限はどのように管理されていますか？
A. システム管理者がユーザーごとに権限設定を行っています。

### Q40. 他のユーザーが同時に編集した場合はどうなりますか？
A. 最後に保存した内容が反映されます。競合が発生した場合はエラーとなることがあります。

### Q41. テーブルのデータを印刷できますか？
A. ブラウザの印刷機能で印刷可能ですが、レイアウトが崩れる場合があります。

### Q42. テーブルのデータをコピー＆ペーストできますか？
A. セル単位でコピーは可能ですが、複数セルの一括コピーは未対応です。

### Q43. テーブルのフィルタ機能はありますか？
A. 現状は全カラム横断の部分一致検索のみです。

### Q44. テーブルのソート機能はありますか？
A. 現状は未対応です。今後のアップデートで追加予定です。

### Q45. テーブルのカラム順を入れ替えられますか？
A. 現状はできません。

### Q46. テーブルのカラム名は変更できますか？
A. システム管理者がconfig.jsを編集することで変更可能です。

### Q47. テーブルのカラム幅は自動調整されますか？
A. 初期表示時に自動調整されますが、手動調整はできません。

### Q48. テーブルのセルにツールチップは表示されますか？
A. 一部のセルではツールチップが表示される場合があります。

### Q49. テーブルのセルにリンクを設定できますか？
A. 詳細リンク列など、一部のカラムでリンクが設定されています。

### Q50. テーブルのセルに画像を表示できますか？
A. 現状は未対応です。

### Q51. テーブルのセルに数式や計算結果を表示できますか？
A. 計算フィールドがある場合は自動で計算結果が表示されます。

### Q52. テーブルのセルに色を付けられますか？
A. 編集時や不整合時など、条件に応じて自動で色が変わります。

### Q53. テーブルのセルにコメントを付けられますか？
A. 現状は未対応です。

### Q54. テーブルのセルにチェックボックスを表示できますか？
A. 変更フラグ列などでチェックボックスが表示されます。

### Q55. テーブルのセルにドロップダウンを表示できますか？
A. 編集可能なセルでドロップダウンが利用される場合があります。

### Q56. テーブルのセルに日付ピッカーを表示できますか？
A. 日付型フィールドの場合は日付ピッカーが表示されます。

### Q57. テーブルのセルにユーザー選択を表示できますか？
A. ユーザーIDフィールドでユーザーリストから選択できます。

### Q58. テーブルのセルに複数選択肢を表示できますか？
A. チェックボックス型フィールドで複数選択が可能です。

### Q59. テーブルのセルにラジオボタンを表示できますか？
A. ラジオボタン型フィールドで表示されます。

### Q60. テーブルのセルにファイル添付はできますか？
A. 現状は未対応です。

### Q61. テーブルのセルに数値のみ入力できますか？
A. 数値型フィールドでは数値のみ入力可能です。

### Q62. テーブルのセルに必須入力の制御はありますか？
A. 必須フィールドは空欄で保存できません。

### Q63. テーブルのセルに初期値は設定できますか？
A. システム管理者が設定することで可能です。

### Q64. テーブルのセルに最大文字数制限はありますか？
A. フィールドごとに最大文字数が設定されている場合があります。

### Q65. テーブルのセルに入力値のバリデーションはありますか？
A. 入力内容に応じてバリデーションが行われます。

### Q66. テーブルのセルに入力補完はありますか？
A. 現状は未対応です。

### Q67. テーブルのセルに入力履歴は残りますか？
A. 現状は残りません。

### Q68. テーブルのセルに入力ミスがあった場合はどうなりますか？
A. エラーメッセージが表示され、保存できません。

### Q69. テーブルのセルに入力した内容を一括でクリアできますか？
A. 現状は未対応です。

### Q70. テーブルのセルに入力した内容を一括でコピーできますか？
A. 現状は未対応です。

---

ご不明点があれば、画面右上の「ヘルプ」または管理者までお問い合わせください。 