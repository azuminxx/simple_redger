## 座席表 実装計画（Fabric.js + Plain JS）

### 方針
- 既存コードと極力分離（React不使用、Fabric.js依存のみ）。
- 新規タブ「座席表」を追加し、専用モジュール `js/modules/seatmap/SeatMap.js` を作成。
- 既存の検索〜統合〜表示のロジックは温存。座席表は座席台帳を起点に必要情報を横断参照。

### 依存
- Fabric.js（ローカル同梱、`dest/customize-manifest.json` に登録）

### kintone フィールド（新規/利用）
- 座席台帳（appId=8）
  - `座席表表示`（radio: `true` / `false`）
  - `座標X`（number）
  - `座標Y`（number）
  - `幅`（number）
  - `高さ`（number）
- 内線台帳（appId=7）
  - `座席表注記`（1行テキスト）
- 既存フィールド利用
  - `座席拠点`, `階`, `座席番号`, `座席部署`（座席台帳）

### UI（座席表タブ）
- 上部コントロール
  - 拠点+階（単一プルダウン、初期選択肢）
    - 池袋CO19F, 埼玉CO2F, 埼玉CO3F, 埼玉CO4F, 文京TO2F, 文京TO5F, 浦和TO2F, 浦和TO3F
  - 「表示」ボタン
  - 編集モードON/OFF、追加（表示ON）、削除（表示OFF）、自動整列、保存、ズーム±、リセット
- Canvas（Fabric）
  - 最大500席の矩形ノード
  - 表示内容（改行で積層）
    - 座席番号（座席台帳）
    - PC番号（PC台帳）
    - 内線番号（内線台帳）
    - 座席部署（座席台帳）
    - 座席表注記（内線台帳）
  - 将来の色分けはルール関数をフック化して対応

### 振る舞い
1) 表示: 座席台帳を「拠点+階+座席表表示=true」で取得 → 統合キーからPC/内線を突合 → 既存座標で描画/未配置は候補
2) 追加/削除: `座席表表示` の ON/OFF（レコードの作成/削除は行わない）
3) 編集: ドラッグ&リサイズ（編集モード時）
4) 自動整列: 行優先の規則配置（最大500席対応）
5) 保存: 変更差分のみ座席台帳へ一括更新（X/Y/幅/高さ/表示）

### 主要コンポーネント
- `SeatMap`（新規）
  - `init(container)` / `destroy()`
  - `loadAndRender(siteFloor)`（データ取得→描画）
  - `enterEditMode()` / `exitEditMode()`
  - `addSeat(recordId)` / `removeSeat(recordId)`
  - `autoLayout()` / `saveChanges()`
  - `zoomIn()` / `zoomOut()` / `resetView()`
- `TabManager` 改修
  - タブメニューに「座席表」を追加
  - `switchTab('seatmap')` で SeatMap を初期化/破棄

### 実装手順（段階）
1) Fabric.js 追加・manifest登録
2) `SeatMap.js` スケルトン作成（プルダウンと表示ボタン、Canvas生成）
3) 追加/削除（表示フラグ）と保存（座席台帳）
4) ドラッグ&リサイズ、自動整列
5) PC/内線突合表示の拡充
6) ズーム/リセット、パフォーマンス調整
7) 色分けフックの追加

### 注意
- 既存コードの改修は最小限（タブ追加/表示切替）。
- 「フォールバック処理」は行わない方針。


